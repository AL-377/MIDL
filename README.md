# MIDL
Compiler experiment based on MIDL by Aidan Lew.

[![Security Status](https://www.murphysec.com/platform3/v3/badge/1618294701598212096.svg?t=1)](https://www.murphysec.com/accept?code=3dd5bf5204ba38f00545a5c2635e8648&type=1&from=2&t=2)

## usage
#### MIDL -> AST
- Input the midl lines
- Output the formmatted AST(can use the tree.py to visualize it)

#### MIDL -> C++
- Input the midl file
- Output the hxx file  
1、Process the grammatical -> lexical -> semantic analysis  
2、Use the Symbol table to store the message  
3、Generate the hxx file

#### example
- MIDL -> AST  
[midl](https://github.com/AL-377/MIDL/tree/main/txt): see the input.txt , output.txt
- MIDL -> C++  
[hxx](https://github.com/AL-377/MIDL/tree/main/txt): see the inputLines.txt , outputHxx.txt  
analysis sample:  
<div  align="center">
<img src="https://github.com/AL-377/MIDL/blob/main/demo/analysis_sample.png" width="500px">  
</div>

## Code Structure
### utils
There are some tools I have created to aid the progress.

#### tree.py
- Func:  This is for AST visualization（AST format -> AST tree）
- Input：the paths generated by AST visitor（see also ASTFormat.java , MIDL2AST.java）
- Output: AST Tree Picture
<div  align="center">
<img src="https://github.com/AL-377/MIDL/blob/main/demo/tree_sample.png" height="500px">  
</div>
Tip: The AST format（output of ASTFormat） is like ： root（son1（son11（）...）son2（）...）

### src
The source files and files for definition.

#### MIDLLEX.g4
Lexical definition

#### MIDL.g4
Grammatical definition

#### gen
The files for grammatical and lexical analysis.(generated by ANTLR)

#### ast
- ASTFormat.java: The AST formatter
- MIDL2AST.java: MIDL to AST(entrance)

#### precheck
- Calculator.java: Semantic calculation
- ErrorRecorder.java: Record the errors
- MeanCheck.java: Semantic analysis
- PreCheck.java: Integrate the front process of the Compiler. (entrance)

#### symtab
Define the symbol table,the structure is illustrated in the following png.
- SymList.java
- SymNode.java
- SymTab.java
- TestSymTab.java
<div  align="center">
<img src="https://github.com/AL-377/MIDL/blob/main/demo/symtab.png" width="500px">  
</div>


#### backGen
- GenHxx.java: MIDL->Hxx（main entrance）
- hxxTemplate.stg: define hxx templates files(search **stringTemplate** for more details)
- msgStructure: define the data structure to store the message from symtable(used to fill the hxx templates) 



